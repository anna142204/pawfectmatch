openapi: 3.1.0
info:
  title: PawfectMatch API
  description: >
    API for PawfectMatch, a platform that connects animal adopters with pets available for adoption.
    Users can register as adopters or owners, browse available animals, match with animals if the owner agrees,
    and communicate through a discussion system.
  version: 1.0.0

servers:
  - url: http://localhost:8989
    description: Development server

paths:
  # Authentication Endpoints
  /api/auth/register/adopter:
    post:
      summary: Register a new adopter
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - firstName
                - lastName
                - email
                - password
                - age
                - address
              properties:
                firstName:
                  type: string
                  maxLength: 100
                  example: Marie
                lastName:
                  type: string
                  maxLength: 100
                  example: Martin
                email:
                  type: string
                  format: email
                  maxLength: 254
                  example: marie.martin@example.com
                password:
                  type: string
                  minLength: 6
                  maxLength: 128
                  example: securePassword123
                age:
                  type: integer
                  minimum: 18
                  example: 28
                address:
                  type: object
                  required:
                    - zip
                    - city
                  properties:
                    zip:
                      type: string
                      maxLength: 12
                      description: Invalid request or animal not available
                      content:
                        application/json:
                          schema:
                            type: object
                            properties:
                              error:
                                type: string
                                example: "adopterId and animalId are required"
                    city:
                      description: Adopter or animal not found
                      content:
                        application/json:
                          schema:
                            type: object
                            properties:
                              error:
                                type: string
                                example: "Adopter not found"
                      maxLength: 100
                      description: Match already exists
                      content:
                        application/json:
                          schema:
                            type: object
                            properties:
                              error:
                                type: string
                                example: "Match already exists"
                about:
                      description: Create match error
                      content:
                        application/json:
                          schema:
                            type: object
                            properties:
                              error:
                                type: string
                                example: "Failed to create match"
                  maxLength: 150
                  example: Passionné par les animaux
                preferences:
                  type: object
                  properties:
                    environment:
                    - name: adopterId
                      in: query
                      schema:
                        type: string
                    - name: animalId
                      in: query
                      schema:
                        type: string
                    - name: isActive
                      in: query
                      schema:
                        type: boolean
                      type: array
                      items:
                        type: string
                        enum: [appartement, voiture, enfant, chien, chat, autre animaux]
                        maxLength: 30
                      example: [appartement, enfant]
                    species:
                      type: array
                      items:
                        type: string
                        maxLength: 50
                      example: [chat, chien]
                    sizePreference:
                      type: array
                      items:
                        type: string
                        enum: [petit, moyen, grand]
                        maxLength: 10
                      example: [petit, moyen]
      responses:
        "201":
          description: Adopter registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Adopter registered successfully
                  token:
                    type: string
                  user:
                    $ref: "#/components/schemas/Adopter"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Tous les champs requis doivent être remplis
        "409":
          description: Email already registered
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Cet email est déjà enregistré
        "500":
          description: Registration error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Échec de l'inscription

  /api/auth/register/owner:
    post:
      summary: Register a new owner
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - firstName
                - lastName
                - email
                - password
                - address
              properties:
                firstName:
                  type: string
                  maxLength: 100
                  example: John
                lastName:
                  type: string
                  maxLength: 100
                  example: Doe
                email:
                  type: string
                  format: email
                  maxLength: 254
                  example: john.doe@example.com
                password:
                  type: string
                  minLength: 6
                  maxLength: 128
                  example: securePassword123
                phoneNumber:
                  type: string
                  maxLength: 30
                  example: "+41 79 123 45 67"
                societyName:
                  type: string
                  maxLength: 150
                address:
                  type: object
                  required:
                    - zip
                    - city
                  properties:
                    zip:
                      type: string
                      maxLength: 12
                    city:
                      type: string
                      maxLength: 100
                about:
                  type: string
                  maxLength: 150
      responses:
        "201":
          description: Owner registered successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Owner registered successfully
                  token:
                    type: string
                  user:
                    $ref: "#/components/schemas/Owner"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Tous les champs requis doivent être remplis
        "409":
          description: Email already registered
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Cet email est déjà enregistré
        "500":
          description: Registration error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Échec de l'inscription

  /api/auth/login:
    post:
      summary: Login user (adopter or owner)
      tags:
        - Authentication
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - email
                - password
              properties:
                email:
                  type: string
                  format: email
                  maxLength: 254
                  example: marie.martin@example.com
                password:
                  type: string
                  minLength: 6
                  maxLength: 128
                  example: securePassword123
      responses:
        "200":
          description: Login successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  token:
                    type: string
                  user:
                    type: object
                    description: User object (Adopter, Owner, or Admin)
                  type:
                    type: string
                    enum: [adopter, owner, admin]
                    example: adopter
        "400":
          description: Missing required fields
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Email et mot de passe requis
        "401":
          description: Invalid credentials
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Email ou mot de passe invalide
        "500":
          description: Login error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Échec de la connexion

  /api/auth/logout:
    post:
      summary: Logout user
      tags:
        - Authentication
      responses:
        "200":
          description: Logout successful
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
        "500":
          description: Logout error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string

  # Image Upload Routes
  /api/upload/image:
    post:
      summary: Upload a single image
      tags:
        - Images
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - image
              properties:
                image:
                  type: string
                  format: binary
                  description: Image file to upload
      responses:
        "200":
          description: Image uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  url:
                    type: string
                    format: url
                    description: URL of the uploaded image
                  publicId:
                    type: string
                    description: Cloudinary public ID of the image
                  message:
                    type: string
                    example: Image uploadée avec succès
        "400":
          description: Invalid image
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Aucun fichier fourni
        "500":
          description: Upload error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Erreur lors de l'upload de l'image

    delete:
      summary: Delete an image
      tags:
        - Images
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - publicId
              properties:
                publicId:
                  type: string
                  description: Cloudinary public ID of the image to delete
      responses:
        "200":
          description: Image deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Image supprimée avec succès
        "400":
          description: Missing publicId
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: publicId requis
        "500":
          description: Delete error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Erreur lors de la suppression de l'image

  /api/upload/images:
    post:
      summary: Upload multiple images (max 10)
      tags:
        - Images
      requestBody:
        required: true
        content:
          multipart/form-data:
            schema:
              type: object
              required:
                - images
              properties:
                images:
                  type: array
                  items:
                    type: string
                    format: binary
                  maxItems: 10
                  description: Images to upload (max 10 files)
      responses:
        "200":
          description: Images uploaded successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  images:
                    type: array
                    items:
                      type: object
                      properties:
                        url:
                          type: string
                          format: url
                        publicId:
                          type: string
                  message:
                    type: string
                    example: 3 image(s) uploadée(s) avec succès
        "400":
          description: Invalid images
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Aucun fichier fourni
        "500":
          description: Upload error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Erreur lors de l'upload des images

  # Animal Endpoints
  /api/animals:
    post:
      summary: Create a new animal
      tags:
        - Animals
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - species
                - name
                - age
                - sex
                - address
                - image
                - price
                - ownerId
                - description
                - characteristics
              properties:
                species:
                  type: string
                  maxLength: 50
                  enum: [chat, chien, lapin, oiseau, rongeur, autre]
                  example: chien
                race:
                  type: string
                  maxLength: 80
                  example: Labrador
                name:
                  type: string
                  maxLength: 80
                  example: Buddy
                age:
                  type: string
                  enum: ['0-1', '1-3', '3-7', '7+']
                  example: "3-7"
                sex:
                  type: string
                  maxLength: 10
                  enum: [male, female]
                size:
                  type: string
                  maxLength: 10
                  enum: [petit, moyen, grand]
                  example: grand
                weight:
                  type: string
                  maxLength: 10
                  enum: ["0-5", "5-10", "10-20", "20-30", "30+"]
                  example: "20-30"
                address:
                  type: object
                  required:
                    - city
                    - zip
                  properties:
                    city:
                      type: string
                      maxLength: 100
                    zip:
                      type: string
                      maxLength: 12
                image:
                  type: string
                  format: url
                  maxLength: 500
                price:
                  type: number
                  minimum: 0
                  example: 150
                ownerId:
                  type: string
                  description: ID of the owner (references Owner model)
                availability:
                  type: boolean
                  default: true
                description:
                  type: string
                  maxLength: 300
                characteristics:
                  type: object
                  required:
                    - environment
                    - dressage
                    - personality
                  properties:
                    environment:
                      type: array
                      items:
                        type: string
                        maxLength: 30
                        enum: [appartement, voiture, enfant, chien, chat, "autre animaux"]
                      minItems: 1
                    dressage:
                      type: array
                      items:
                        type: string
                        maxLength: 30
                        enum: [éduqué, "facile à dresser", "habitué à la laisse", têtu]
                      minItems: 1
                    personality:
                      type: array
                      items:
                        type: string
                        maxLength: 30
                        enum: [calme, énergique, indépendant, affectueux, curieux, joueur, bavard, explorateur, câlin, protecteur, territorial, sociable, timide, peureux]
                      minItems: 1
      responses:
        "201":
          description: Animal created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Animal créé avec succès"
                  animal:
                    $ref: "#/components/schemas/Animal"
        "400":
          description: Validation error - required fields missing
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Tous les champs requis doivent être remplis"
        "500":
          description: Server error creating animal
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Échec de la création de l'animal"
                  details:
                    type: string

    get:
      summary: Get list of all animals with pagination and filtering
      tags:
        - Animals
      parameters:
        - name: species
          in: query
          schema:
            type: string
            enum: [chat, chien, lapin, oiseau, rongeur, autre]
        - name: race
          in: query
          schema:
            type: string
            maxLength: 80
        - name: name
          in: query
          schema:
            type: string
            maxLength: 80
        - name: age
          in: query
          schema:
            type: string
            enum: ['0-1', '1-3', '3-7', '7+']
        - name: sex
          in: query
          schema:
            type: string
            enum: [male, female]
        - name: city
          in: query
          schema:
            type: string
            maxLength: 100
        - name: zip
          in: query
          schema:
            type: string
            maxLength: 12
        - name: minPrice
          in: query
          schema:
            type: number
            minimum: 0
        - name: maxPrice
          in: query
          schema:
            type: number
            minimum: 0
        - name: ownerId
          in: query
          schema:
            type: string
        - name: availability
          in: query
          schema:
            type: boolean
        - name: environment
          in: query
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
              maxLength: 30
              enum: [appartement, voiture, enfant, chien, chat, "autre animaux"]
        - name: dressage
          in: query
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
              maxLength: 30
              enum: [éduqué, "facile à dresser", "habitué à la laisse", têtu]
        - name: personality
          in: query
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
              maxLength: 30
              enum: [calme, énergique, indépendant, affectueux, curieux, joueur, bavard, explorateur, câlin, protecteur, territorial, sociable, timide, peureux]
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
      responses:
        "200":
          description: List of animals
          content:
            application/json:
              schema:
                type: object
                properties:
                  animals:
                    type: array
                    items:
                      $ref: "#/components/schemas/Animal"
                  pagination:
                    $ref: "#/components/schemas/Pagination"
        "500":
          description: Server error fetching animals
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Failed to fetch animals"

  /api/animals/{id}:
    get:
      summary: Get animal by ID
      tags:
        - Animals
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Animal found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Animal"
        "404":
          description: Animal not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Animal not found"
        "500":
          description: Server error fetching animal
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Failed to fetch animal"

    put:
      summary: Update an animal by ID
      tags:
        - Animals
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
                species:
                  type: string
                  maxLength: 50
                  enum: [chat, chien, lapin, oiseau, rongeur, autre]
                  type: string
                  maxLength: 80
                name:
                  type: string
                  maxLength: 80
                age:
                  type: string
                  enum: ['0-1', '1-3', '3-7', '7+']
                  type: string
                  maxLength: 10
                  enum: [male, female]
                size:
                  type: string
                  maxLength: 10
                  enum: [petit, moyen, grand]
                weight:
                  type: string
                  maxLength: 10
                  enum: ["0-5", "5-10", "10-20", "20-30", "30+"]
                address:
                  type: object
                  properties:
                    city:
                      type: string
                      maxLength: 100
                    zip:
                      type: string
                      maxLength: 12
                image:
                  type: string
                  format: url
                  maxLength: 500
                price:
                  type: number
                  minimum: 0
                availability:
                  type: boolean
                description:
                  type: string
                  maxLength: 300
                characteristics:
                  type: object
                  properties:
                    environment:
                      type: array
                      items:
                        type: string
                        maxLength: 30
                        enum: [appartement, voiture, enfant, chien, chat, "autre animaux"]
                      minItems: 1
                    dressage:
                      type: array
                      items:
                        type: string
                        maxLength: 30
                        enum: [éduqué, "facile à dresser", "habitué à la laisse", têtu]
                      minItems: 1
                    personality:
                      type: array
                      items:
                        type: string
                        maxLength: 30
                        enum: [calme, énergique, indépendant, affectueux, curieux, joueur, bavard, explorateur, câlin, protecteur, territorial, sociable, timide, peureux]
                      minItems: 1
      responses:
        "200":
          description: Animal updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Animal updated successfully"
                  animal:
                    $ref: "#/components/schemas/Animal"
        "400":
          description: Validation error in update request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "404":
          description: Animal not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Animal not found"
        "500":
          description: Server error updating animal
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Failed to update animal"

    delete:
      summary: Delete an animal by ID
      tags:
        - Animals
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Animal deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Animal deleted successfully"
        "404":
          description: Animal not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Animal not found"
        "500":
          description: Server error deleting animal
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Failed to delete animal"

  # Adopter Endpoints
  /api/adopters:
    get:
      summary: Get list of all adopters with pagination and filtering
      tags:
        - Adopters
      parameters:
        - name: firstName
          in: query
          schema:
            type: string
            maxLength: 100
          example: Alice
        - name: lastName
          in: query
          schema:
            type: string
            maxLength: 100
          example: Martin
        - name: email
          in: query
          schema:
            type: string
            format: email
            maxLength: 254
          example: alice@example.com
        - name: city
          in: query
          schema:
            type: string
            maxLength: 100
          example: Lausanne
        - name: zip
          in: query
          schema:
            type: string
            maxLength: 12
          example: "1000"
        - name: minAge
          in: query
          schema:
            type: integer
            minimum: 18
          example: 18
        - name: maxAge
          in: query
          schema:
            type: integer
            minimum: 18
          example: 65
        - name: environment
          in: query
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
              enum: [appartement, voiture, enfant, chien, chat, "autre animaux"]
              maxLength: 30
          example: [appartement, enfant]
        - name: species
          in: query
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
              maxLength: 50
          example: [chat, chien]
        - name: sizePreference
          in: query
          style: form
          explode: true
          schema:
            type: array
            items:
              type: string
              enum: [petit, moyen, grand]
              maxLength: 10
          example: [moyen, grand]
        - name: page
          in: query
          schema:
            type: integer
            default: 1
            minimum: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
            minimum: 1
      responses:
        "200":
          description: List of adopters
          content:
            application/json:
              schema:
                type: object
                properties:
                  adopters:
                    type: array
                    items:
                      $ref: "#/components/schemas/Adopter"
                  pagination:
                    $ref: "#/components/schemas/Pagination"
        "500":
          description: Get adopters error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to fetch adopters

  /api/adopters/{id}:
    get:
      summary: Get adopter by ID
      tags:
        - Adopters
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Adopter found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Adopter"
        "404":
          description: Adopter not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Adopter not found
        "500":
          description: Get adopter error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to fetch adopter

    put:
      summary: Update an adopter by ID
      tags:
        - Adopters
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                firstName:
                  type: string
                  maxLength: 100
                  example: Alice
                lastName:
                  type: string
                  maxLength: 100
                  example: Martin
                email:
                  type: string
                  format: email
                  maxLength: 254
                  example: alice@example.com
                age:
                  type: integer
                  minimum: 18
                  example: 28
                address:
                  type: object
                  properties:
                    zip:
                      type: string
                      maxLength: 12
                      example: "1000"
                    city:
                      type: string
                      maxLength: 100
                      example: Lausanne
                about:
                  type: string
                  maxLength: 150
                  example: "Aime les animaux et vit en appartement"
                preferences:
                  type: object
                  properties:
                    environment:
                      type: array
                      items:
                        type: string
                        enum: [appartement, voiture, enfant, chien, chat, "autre animaux"]
                        maxLength: 30
                      example: [appartement, enfant]
                    species:
                      type: array
                      items:
                        type: string
                        maxLength: 50
                      example: [chat, chien]
                    sizePreference:
                      type: array
                      items:
                        type: string
                        enum: [petit, moyen, grand]
                        maxLength: 10
                      example: [moyen]
      responses:
        "200":
          description: Adopter updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Adopter updated successfully
                  adopter:
                    $ref: "#/components/schemas/Adopter"
        "400":
          description: Validation error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "404":
          description: Adopter not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Adopter not found
        "500":
          description: Update adopter error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to update adopter

    delete:
      summary: Delete an adopter by ID
      tags:
        - Adopters
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Adopter deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: Adopter deleted successfully
        "404":
          description: Adopter not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Adopter not found
        "500":
          description: Delete adopter error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: Failed to delete adopter

  # Owner Endpoints
  /api/owners:
    get:
      summary: Get list of all owners with pagination and filtering
      tags:
        - Owners
      parameters:
        - name: firstName
          in: query
          schema:
            type: string
            maxLength: 100
        - name: lastName
          in: query
          schema:
            type: string
            maxLength: 100
        - name: email
          in: query
          schema:
            type: string
            format: email
            maxLength: 254
        - name: phoneNumber
          in: query
          schema:
            type: string
            maxLength: 30
        - name: city
          in: query
          schema:
            type: string
            maxLength: 100
        - name: zip
          in: query
          schema:
            type: string
            maxLength: 12
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
      responses:
        "200":
          description: List of owners
          content:
            application/json:
              schema:
                type: object
                properties:
                  owners:
                    type: array
                    items:
                      $ref: "#/components/schemas/Owner"
                  pagination:
                    $ref: "#/components/schemas/Pagination"
        "500":
          description: Server error fetching owners
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Failed to fetch owners"

  /api/owners/{id}:
    get:
      summary: Get owner by ID with associated animals
      tags:
        - Owners
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Owner found with associated animals
          content:
            application/json:
              schema:
                allOf:
                  - $ref: "#/components/schemas/Owner"
                  - type: object
                    properties:
                      animals:
                        type: array
                        items:
                          $ref: "#/components/schemas/Animal"
        "404":
          description: Owner not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Owner not found"
        "500":
          description: Server error fetching owner
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Failed to fetch owner"

    put:
      summary: Update an owner by ID
      tags:
        - Owners
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        description: Password updates are not allowed on this route
        content:
          application/json:
            schema:
              type: object
              properties:
                firstName:
                  type: string
                  maxLength: 100
                lastName:
                  type: string
                  maxLength: 100
                email:
                  type: string
                  format: email
                  maxLength: 254
                phoneNumber:
                  type: string
                  maxLength: 30
                societyName:
                  type: string
                  maxLength: 150
                address:
                  type: object
                  properties:
                    zip:
                      type: string
                      maxLength: 12
                    city:
                      type: string
                      maxLength: 100
                about:
                  type: string
                  maxLength: 150
      responses:
        "200":
          description: Owner updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Owner updated successfully"
                  owner:
                    $ref: "#/components/schemas/Owner"
        "400":
          description: Validation error in update request
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
        "404":
          description: Owner not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Owner not found"
        "500":
          description: Server error updating owner
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Failed to update owner"

    delete:
      summary: Delete an owner by ID (only if no associated animals)
      tags:
        - Owners
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Owner deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Owner deleted successfully"
        "400":
          description: Cannot delete owner with associated animals
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Cannot delete owner with associated animals"
                  animalsCount:
                    type: integer
        "404":
          description: Owner not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Owner not found"
        "500":
          description: Server error deleting owner
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Failed to delete owner"

  # Match Endpoints
  /api/matches:
    post:
      summary: Create a new match between adopter and animal
      tags:
        - Matches
      security:
        - BearerAuth: []
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - adopterId
                - animalId
              properties:
                adopterId:
                  type: string
                  description: ID of the adopter
                animalId:
                  type: string
                  description: ID of the animal
                isActive:
                  type: boolean
                  default: true
      responses:
        "201":
          description: Match created successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Match created successfully"
                  match:
                    $ref: "#/components/schemas/Match"
        "400":
          description: Invalid request or animal not available
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "adopterId and animalId are required"
        "404":
          description: Adopter or animal not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Adopter not found"
        "409":
          description: Match already exists
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Match already exists"
        "500":
          description: Create match error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Failed to create match"

    get:
      summary: Get list of all matches with pagination
      tags:
        - Matches
      parameters:
        - name: adopterId
          in: query
          schema:
            type: string
        - name: animalId
          in: query
          schema:
            type: string
        - name: isActive
          in: query
          schema:
            type: boolean
        - name: page
          in: query
          schema:
            type: integer
            default: 1
        - name: limit
          in: query
          schema:
            type: integer
            default: 20
      responses:
        "200":
          description: List of matches
          content:
            application/json:
              schema:
                type: object
                properties:
                  matches:
                    type: array
                    items:
                      $ref: "#/components/schemas/Match"
                  pagination:
                    $ref: "#/components/schemas/Pagination"
        "500":
          description: Get matches error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Failed to fetch matches"

  /api/matches/{id}:
    get:
      summary: Get match by ID
      tags:
        - Matches
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Match found
          content:
            application/json:
              schema:
                $ref: "#/components/schemas/Match"
        "404":
          description: Match not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Match not found"
        "500":
          description: Get match error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Failed to fetch match"

    put:
      summary: Update a match by ID
      tags:
        - Matches
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              properties:
                isActive:
                  type: boolean
      responses:
        "200":
          description: Match updated successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Match updated successfully"
                  match:
                    $ref: "#/components/schemas/Match"
        "404":
          description: Match not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Match not found"
        "500":
          description: Update match error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Failed to update match"

    delete:
      summary: Delete a match by ID
      tags:
        - Matches
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Match deleted successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Match deleted successfully"
        "404":
          description: Match not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Match not found"
        "500":
          description: Delete match error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Failed to delete match"

  /api/matches/{id}/messages:
    post:
      summary: Add a message to match discussion
      tags:
        - Matches
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      requestBody:
        required: true
        content:
          application/json:
            schema:
              type: object
              required:
                - sender
                - senderModel
                - message
              properties:
                sender:
                  type: string
                  description: ID of the sender (adopter or owner)
                senderModel:
                  type: string
                  enum: [Adopter, Owner]
                  maxLength: 20
                message:
                  type: string
                  maxLength: 1000
      responses:
        "200":
          description: Message added successfully
          content:
            application/json:
              schema:
                type: object
                properties:
                  message:
                    type: string
                    example: "Message added successfully"
                  match:
                    $ref: "#/components/schemas/Match"
        "400":
          description: Invalid message data or inactive match
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "sender, senderModel, and message are required"
        "404":
          description: Match not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Match not found"
        "500":
          description: Add message error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Failed to add message"

  /api/matches/{id}/discussion:
    get:
      summary: Get match discussion messages
      tags:
        - Matches
      parameters:
        - name: id
          in: path
          required: true
          schema:
            type: string
      responses:
        "200":
          description: Discussion messages
          content:
            application/json:
              schema:
                type: object
                properties:
                  matchId:
                    type: string
                  adopterId:
                    type: string
                  animalId:
                    type: string
                  isActive:
                    type: boolean
                  discussion:
                    type: array
                    items:
                      type: object
                      properties:
                        sender:
                          type: string
                        senderModel:
                          type: string
                          enum: [Adopter, Owner]
                        message:
                          type: string
                          maxLength: 1000
                        timestamp:
                          type: string
                          format: date-time
        "404":
          description: Match not found
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Match not found"
        "500":
          description: Get discussion error
          content:
            application/json:
              schema:
                type: object
                properties:
                  error:
                    type: string
                    example: "Failed to fetch discussion"

  # Admin Routes
  /api/admin/stats:
    get:
      summary: Get API statistics
      tags:
        - Admin
      responses:
        "200":
          description: API statistics
          content:
            application/json:
              schema:
                type: object
                properties:
                  totalAdopters:
                    type: number
                  totalOwners:
                    type: number
                  totalAnimals:
                    type: number
                  totalMatches:
                    type: number
        "500":
          description: Error retrieving statistics

components:
  schemas:
    Adopter:
      type: object
      properties:
        _id:
          type: string
          format: uuid
        firstName:
          type: string
          maxLength: 100
        lastName:
          type: string
          maxLength: 100
        email:
          type: string
          format: email
          maxLength: 254
        age:
          type: integer
          minimum: 18
        address:
          type: object
          properties:
            zip:
              type: string
              maxLength: 12
            city:
              type: string
              maxLength: 100
        about:
          type: string
          maxLength: 150
        preferences:
          type: object
          properties:
            environment:
              type: array
              items:
                type: string
                enum: [appartement, voiture, enfant, chien, chat, "autre animaux"]
                maxLength: 30
            species:
              type: array
              items:
                type: string
                maxLength: 50
            sizePreference:
              type: array
              items:
                type: string
                enum: [petit, moyen, grand]
                maxLength: 10
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        __v:
          type: number

    Owner:
      type: object
      properties:
        _id:
          type: string
          format: uuid
        firstName:
          type: string
        lastName:
          type: string
        email:
          type: string
          format: email
        phoneNumber:
          type: string
        address:
          type: object
          properties:
            zip:
              type: string
            city:
              type: string
        about:
          type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        __v:
          type: number

    Animal:
      type: object
      properties:
        _id:
          type: string
          format: uuid
        species:
          type: string
        race:
          type: string
        name:
          type: string
        age:
          type: number
        sex:
          type: string
          enum: [male, female]
        size:
          type: string
          enum: [petit, moyen, grand]
        weight:
          type: string
        address:
          type: object
          properties:
            city:
              type: string
            zip:
              type: string
        image:
          type: string
          format: url
        price:
          type: number
        ownerId:
          type: string
        availability:
          type: boolean
        description:
          type: string
        characteristics:
          type: object
          properties:
            environment:
              type: array
              items:
                type: string
            dressage:
              type: array
              items:
                type: string
            personality:
              type: array
              items:
                type: string
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        __v:
          type: number

    Match:
      type: object
      properties:
        _id:
          type: string
          format: uuid
        adopterId:
          oneOf:
            - type: string
            - $ref: "#/components/schemas/Adopter"
        animalId:
          oneOf:
            - type: string
            - $ref: "#/components/schemas/Animal"
        isActive:
          type: boolean
        discussion:
          type: array
          items:
            type: object
            properties:
              sender:
                type: string
              senderModel:
                type: string
                enum: [Adopter, Owner]
              message:
                type: string
              timestamp:
                type: string
                format: date-time
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        __v:
          type: number

    Pagination:
      type: object
      properties:
        total:
          type: integer
        page:
          type: integer
        limit:
          type: integer
        pages:
          type: integer

    Admin:
      type: object
      properties:
        _id:
          type: string
          format: uuid
        email:
          type: string
          format: email
          maxLength: 254
        name:
          type: string
          maxLength: 100
        role:
          type: string
          maxLength: 20
          default: admin
        createdAt:
          type: string
          format: date-time
        updatedAt:
          type: string
          format: date-time
        __v:
          type: number

  securitySchemes:
    BearerAuth:
      type: http
      scheme: bearer
      bearerFormat: JWT

tags:
  - name: Authentication
    description: User registration and login endpoints
  - name: Adopters
    description: Adopter management endpoints (GET, POST, PUT, DELETE)
  - name: Owners
    description: Owner management endpoints (GET, POST, PUT, DELETE)
  - name: Animals
    description: Animal listings and management (GET, POST, PUT, DELETE)
  - name: Matches
    description: Match creation and discussion management (GET, POST, PUT, DELETE, messages)
  - name: Images
    description: Image upload and deletion (POST, DELETE)
  - name: Admin
    description: Administrative endpoints for statistics